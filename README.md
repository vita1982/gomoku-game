# 五子棋游戏 (Gomoku Game)

一个使用 TypeScript + Vite 构建的现代化五子棋游戏，支持 AI 对战、悔棋、游戏存档等丰富功能。

## ✨ 功能特性

### 🎮 核心功能
- ✅ **标准棋盘**：15x15 标准五子棋棋盘，带星位标记
- ✅ **双人对战**：黑白双方交替对弈
- ✅ **AI 对战**：内置智能 AI，支持单人游戏
- ✅ **自动判定**：自动检测五子连珠获胜和平局

### 🤖 AI 功能
- ✅ **智能策略**：基于评分系统的 AI 算法
  - 优先进攻：检测并完成获胜机会
  - 积极防守：阻止对手形成五连
  - 位置评估：评估每个位置的战略价值
- ✅ **难度适中**：适合新手到中级玩家挑战

### 🔄 游戏管理
- ✅ **悔棋功能**：支持撤销上一步操作
  - PVP 模式：撤销一步
  - PVE 模式：撤销两步（玩家和 AI）
- ✅ **游戏历史**：完整记录每步落子信息
  - 落子位置、玩家、时间戳、序号
- ✅ **本地存储**：自动保存游戏进度
  - 页面刷新后自动恢复
  - 游戏结束后自动清除

### 🎨 界面功能
- ✅ **落子序号**：棋子上显示落子顺序，方便复盘
- ✅ **鼠标预览**：悬停显示半透明预览棋子
- ✅ **星位标记**：标准五子棋星位（天元和四角）
- ✅ **精美 UI**：渐变色背景、动画效果、阴影设计
- ✅ **响应式布局**：完美支持桌面端和移动端
  - 768px 以下优化布局
  - 480px 以下进一步调整

### ⚡ 性能优化
- ✅ **离屏画布**：缓存棋盘背景，减少重绘
- ✅ **增量绘制**：只绘制新落下的棋子
- ✅ **响应式 Canvas**：动态调整画布尺寸，无缩放失真
- ✅ **类型安全**：完整的 TypeScript 类型支持

## 🎯 游戏模式

### 双人对战 (PVP)
- 两位玩家在同一设备上对弈
- 黑方先行，轮流落子
- 支持悔棋功能

### AI 对战 (PVE)
- 玩家（黑方）对战 AI（白方）
- AI 具有一定智能，能够攻防兼备
- 悔棋自动撤销玩家和 AI 的最后一轮

## 🚀 快速开始

### 安装依赖

```bash
npm install
```

### 开发运行

```bash
npm run dev
```

浏览器会自动打开 http://localhost:5173

### 构建项目

```bash
npm run build
```

构建产物将输出到 `dist` 目录。

### 类型检查

```bash
npm run typecheck
```

## 📖 使用说明

### 基本操作
1. **开始游戏**：页面加载后自动开始，黑方先行
2. **落子**：点击棋盘交叉点落子
3. **悔棋**：点击"悔棋"按钮撤销上一步
4. **切换模式**：点击"切换 AI 对战"在 PVP 和 PVE 模式间切换
5. **重新开始**：点击"重新开始"按钮开始新游戏

### 游戏提示
- 鼠标悬停在空位上会显示预览棋子
- 当前玩家显示在顶部状态栏
- AI 模式下白方玩家标记为 "白方 (AI)"
- 棋子上的数字表示落子顺序
- 游戏会自动保存，刷新页面可继续

## 📱 移动端支持

游戏完美支持移动设备：
- ✅ 自动适配屏幕尺寸
- ✅ 触摸操作支持
- ✅ 响应式按钮布局
- ✅ 优化的字体大小

## 🎮 游戏规则

1. **基本规则**
   - 黑方先行，黑白双方交替落子
   - 在横、竖、斜任意方向形成连续五子即获胜
   - 棋盘下满且无人获胜则为平局

2. **落子规则**
   - 只能在空的交叉点落子
   - 落子后不可移动（除非悔棋）
   - 游戏结束后不能继续落子

## 🛠️ 技术栈

- **TypeScript** - 类型安全的 JavaScript 超集
- **Vite** - 极速的前端构建工具
- **Canvas API** - 高性能 2D 图形渲染
- **localStorage** - 浏览器本地存储
- **ES Modules** - 现代模块化标准

## 📁 项目结构

```
gomoku-game/
├── src/
│   ├── main.ts      # 游戏主逻辑（AI、绘制、状态管理）
│   └── style.css    # 样式文件（响应式、动画）
├── dist/            # 构建输出目录
├── index.html       # HTML 入口
├── package.json     # 项目配置
├── tsconfig.json    # TypeScript 配置
└── vite.config.ts   # Vite 配置
```

## 🔧 核心实现

### AI 算法
```typescript
// AI 决策流程
1. 检查是否有获胜机会 → 立即落子
2. 检查是否需要防守 → 阻止对手
3. 评估所有空位得分 → 选择最佳位置
4. 考虑中心位置加成 → 优化布局
```

### 性能优化
```typescript
// 离屏画布缓存背景
offscreenCanvas → 绘制网格和星位 → 缓存
每次刷新 → 复制离屏画布 → 只绘制棋子
```

### 响应式 Canvas
```typescript
// 动态计算尺寸
canvasSize = min(windowWidth - 60, 600)
scale = canvasSize / 600
cellSize = 40 * scale
pieceRadius = 15 * scale
```

## 🐛 问题反馈

如果发现 bug 或有功能建议，请在 [Issues](https://github.com/vita1982/gomoku-game/issues) 中提出。

## 📝 更新日志

### v1.1.0 (2025-10-31)
- ✅ 修复移动端 Canvas 响应式问题
- ✅ 新增 AI 对战模式
- ✅ 新增悔棋功能
- ✅ 新增游戏历史记录
- ✅ 新增本地存储功能
- ✅ 新增落子序号显示
- ✅ 新增鼠标悬停预览
- ✅ 优化 Canvas 绘制性能
- ✅ 改进响应式布局
- ✅ 添加星位标记

### v1.0.0
- ✅ 基础五子棋功能
- ✅ 双人对战模式
- ✅ 基本 UI 设计

## 📄 许可证

MIT

---

**享受游戏！如果觉得不错，请给个 ⭐️ Star 支持一下！**
